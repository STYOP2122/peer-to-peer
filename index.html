<!DOCTYPE html>
<html lang="ru">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
Â  Â  <title>ĞĞ°Ñˆ ĞšĞ°Ğ½Ğ°Ğ»</title>
Â  Â  <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
Â  Â  <style>
Â  Â  Â  Â  :root { --bg: #313338; --sidebar: #2b2d31; --card: #1e1f22; --text: #dbdee1; --accent: #5865f2; --green: #23a559; --red: #f23f42; }
Â  Â  Â  Â  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: var(--text); display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; }
Â  Â  Â  Â  .app-container { background: var(--card); width: 90%; max-width: 400px; border-radius: 12px; overflow: hidden; box-shadow: 0 8px 24px rgba(0,0,0,0.5); }
Â  Â  Â  Â  .header { background: var(--sidebar); padding: 15px; text-align: center; border-bottom: 1px solid #1e1f22; font-weight: bold; }
Â  Â  Â  Â  .channel-info { padding: 20px; text-align: center; }
Â  Â  Â  Â  .user-row { display: flex; align-items: center; justify-content: space-between; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px; margin-bottom: 10px; }
Â  Â  Â  Â  .status-dot { width: 10px; height: 10px; border-radius: 50%; background: #4e5058; margin-right: 10px; }
Â  Â  Â  Â  .online { background: var(--green); box-shadow: 0 0 8px var(--green); }
Â  Â  Â  Â  .controls { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 20px; background: var(--sidebar); }
Â  Â  Â  Â  .btn { border: none; padding: 12px; border-radius: 5px; cursor: pointer; font-weight: 600; color: white; transition: 0.2s; }
Â  Â  Â  Â  .btn-call { grid-column: span 2; background: var(--green); margin-bottom: 10px; }
Â  Â  Â  Â  .btn-mute { background: #4e5058; }
Â  Â  Â  Â  .btn-mute.active { background: var(--red); }
Â  Â  Â  Â  .btn-hangup { grid-column: span 2; background: var(--red); display: none; }
Â  Â  Â  Â  #view-setup { padding: 30px; text-align: center; }
Â  Â  Â  Â  .setup-title { margin-bottom: 20px; font-size: 1.2em; }
Â  Â  </style>
</head>
<body>

<div class="app-container">
Â  Â  <div class="header">ğŸ”Š Ğ“ĞĞ›ĞĞ¡ĞĞ’ĞĞ™ ĞšĞĞĞĞ›</div>

Â  Â  <div id="view-setup">
Â  Â  Â  Â  <div class="setup-title">ĞšÑ‚Ğ¾ Ğ·Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ² ĞºĞ°Ğ½Ğ°Ğ»?</div>
Â  Â  Â  Â  <button class="btn btn-call" style="background: var(--accent);" onclick="init('armenia')">Ğ¯ ĞŸĞĞ Ğ•ĞĞ¬ (ĞÑ€Ğ¼ĞµĞ½Ğ¸Ñ)</button>
Â  Â  Â  Â  <button class="btn btn-call" style="background: #eb459e;" onclick="init('russia')">Ğ¯ Ğ”Ğ•Ğ’Ğ£Ğ¨ĞšĞ (Ğ Ğ¾ÑÑĞ¸Ñ)</button>
Â  Â  </div>

Â  Â  <div id="view-chat" style="display:none;">
Â  Â  Â  Â  <div class="channel-info">
Â  Â  Â  Â  Â  Â  <div class="user-row">
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ‡¦ğŸ‡² ĞÑ€Ğ¼ĞµĞ½Ğ¸Ñ</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="status-armenia" class="status-dot"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="user-row">
Â  Â  Â  Â  Â  Â  Â  Â  <span>ğŸ‡·ğŸ‡º Ğ Ğ¾ÑÑĞ¸Ñ</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div id="status-russia" class="status-dot"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div id="call-status" style="font-size: 0.8em; color: #949ba4; margin-top: 10px;">ĞŸĞ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğº ÑĞµÑ‚Ğ¸...</div>
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="controls">
Â  Â  Â  Â  Â  Â  <button id="call-btn" class="btn btn-call" onclick="makeCall()">ĞŸĞ Ğ˜Ğ¡ĞĞ•Ğ”Ğ˜ĞĞ˜Ğ¢Ğ¬Ğ¡Ğ¯</button>
Â  Â  Â  Â  Â  Â  <button id="hangup-btn" class="btn btn-hangup" onclick="hangUp()">ĞŸĞĞšĞ˜ĞĞ£Ğ¢Ğ¬</button>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <button id="mute-mic" class="btn btn-mute" onclick="toggleMic()">ğŸ¤ ĞœĞ¸ĞºÑ€Ğ¾: Ğ’ĞšĞ›</button>
Â  Â  Â  Â  Â  Â  <button id="mute-audio" class="btn btn-mute" onclick="toggleAudio()">ğŸ§ Ğ—Ğ²ÑƒĞº: Ğ’ĞšĞ›</button>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<audio id="remote-audio" autoplay playsinline></audio>

<script>
Â  Â  const SECRET_KEY = "STABLE-VOICE-2026";
Â  Â  let peer, localStream, currentCall, myRole;
Â  Â  let isMicMuted = false;
Â  Â  let isAudioMuted = false;

Â  Â  async function init(role) {
Â  Â  Â  Â  myRole = role;
Â  Â  Â  Â  const myId = `${role}-${SECRET_KEY}`;
Â  Â  Â  Â  const targetId = (role === 'armenia' ? 'russia' : 'armenia') + "-" + SECRET_KEY;

Â  Â  Â  Â  document.getElementById('view-setup').style.display = 'none';
Â  Â  Â  Â  document.getElementById('view-chat').style.display = 'block';
Â  Â  Â  Â  document.getElementById(`status-${role}`).classList.add('online');

Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  localStream = await navigator.mediaDevices.getUserMedia({ audio: true });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  peer = new Peer(myId, {
Â  Â  Â  Â  Â  Â  Â  Â  config: { 'iceServers': [{ url: 'stun:stun.l.google.com:19302' }, { url: 'stun:stun1.l.google.com:19302' }] }
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  peer.on('open', () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('call-status').innerText = "Ğ’ ÑĞµÑ‚Ğ¸. ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±ĞµÑĞµĞ´Ğ½Ğ¸ĞºĞ°...";
Â  Â  Â  Â  Â  Â  Â  Â  checkPeerStatus(targetId);
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  peer.on('call', (call) => {
Â  Â  Â  Â  Â  Â  Â  Â  currentCall = call;
Â  Â  Â  Â  Â  Â  Â  Â  call.answer(localStream);
Â  Â  Â  Â  Â  Â  Â  Â  handleCall(call);
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  } catch (e) { alert("ĞÑƒĞ¶ĞµĞ½ Ğ¼Ğ¸ĞºÑ€Ğ¾Ñ„Ğ¾Ğ½ Ğ¸ HTTPS!"); }
Â  Â  }

Â  Â  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°, ÑĞ¸Ğ´Ğ¸Ñ‚ Ğ»Ğ¸ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ñ‡ĞµĞ»Ğ¾Ğ²ĞµĞº Ğ² ĞºĞ°Ğ½Ğ°Ğ»Ğµ
Â  Â  function checkPeerStatus(targetId) {
Â  Â  Â  Â  setInterval(() => {
Â  Â  Â  Â  Â  Â  const conn = peer.connect(targetId, { reliable: false });
Â  Â  Â  Â  Â  Â  conn.on('open', () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById(`status-${myRole === 'armenia' ? 'russia' : 'armenia'}`).classList.add('online');
Â  Â  Â  Â  Â  Â  Â  Â  conn.close();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  // Ğ•ÑĞ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· 3 ÑĞµĞº Ğ½ĞµÑ‚ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° - ÑÑ‡Ğ¸Ñ‚Ğ°ĞµĞ¼ Ğ¾Ñ„Ğ»Ğ°Ğ¹Ğ½
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  if (!conn.open) document.getElementById(`status-${myRole === 'armenia' ? 'russia' : 'armenia'}`).classList.remove('online');
Â  Â  Â  Â  Â  Â  }, 3000);
Â  Â  Â  Â  }, 5000);
Â  Â  }

Â  Â  function makeCall() {
Â  Â  Â  Â  const targetId = (myRole === 'armenia' ? 'russia' : 'armenia') + "-" + SECRET_KEY;
Â  Â  Â  Â  currentCall = peer.call(targetId, localStream);
Â  Â  Â  Â  handleCall(currentCall);
Â  Â  }

Â  Â  function handleCall(call) {
Â  Â  Â  Â  document.getElementById('call-btn').style.display = 'none';
Â  Â  Â  Â  document.getElementById('hangup-btn').style.display = 'block';
Â  Â  Â  Â  document.getElementById('call-status').innerText = "Ğ¡Ğ²ÑĞ·ÑŒ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ°";

Â  Â  Â  Â  call.on('stream', stream => {
Â  Â  Â  Â  Â  Â  const audio = document.getElementById('remote-audio');
Â  Â  Â  Â  Â  Â  audio.srcObject = stream;
Â  Â  Â  Â  });
Â  Â  Â  Â  call.on('close', resetUI);
Â  Â  }

Â  Â  function toggleMic() {
Â  Â  Â  Â  isMicMuted = !isMicMuted;
Â  Â  Â  Â  localStream.getAudioTracks()[0].enabled = !isMicMuted;
Â  Â  Â  Â  const btn = document.getElementById('mute-mic');
Â  Â  Â  Â  btn.innerText = isMicMuted ? "ğŸ¤ ĞœĞ¸ĞºÑ€Ğ¾: Ğ’Ğ«ĞšĞ›" : "ğŸ¤ ĞœĞ¸ĞºÑ€Ğ¾: Ğ’ĞšĞ›";
Â  Â  Â  Â  btn.classList.toggle('active', isMicMuted);
Â  Â  }

Â  Â  function toggleAudio() {
Â  Â  Â  Â  isAudioMuted = !isAudioMuted;
Â  Â  Â  Â  document.getElementById('remote-audio').muted = isAudioMuted;
Â  Â  Â  Â  const btn = document.getElementById('mute-audio');
Â  Â  Â  Â  btn.innerText = isAudioMuted ? "ğŸ§ Ğ—Ğ²ÑƒĞº: Ğ’Ğ«ĞšĞ›" : "ğŸ§ Ğ—Ğ²ÑƒĞº: Ğ’ĞšĞ›";
Â  Â  Â  Â  btn.classList.toggle('active', isAudioMuted);
Â  Â  }

Â  Â  function hangUp() {
Â  Â  Â  Â  if (currentCall) currentCall.close();
Â  Â  Â  Â  resetUI();
Â  Â  }

Â  Â  function resetUI() {
Â  Â  Â  Â  document.getElementById('call-btn').style.display = 'block';
Â  Â  Â  Â  document.getElementById('hangup-btn').style.display = 'none';
Â  Â  Â  Â  document.getElementById('call-status').innerText = "Ğ¡Ğ²ÑĞ·ÑŒ Ğ·Ğ°Ğ²ĞµÑ€ÑˆĞµĞ½Ğ°";
Â  Â  }
</script>
</body>
</html>
